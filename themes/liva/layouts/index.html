{{ define "main" }}

<!-- Load Facebook SDK for JavaScript -->
      <div id="fb-root"></div>
      <script>
        window.fbAsyncInit = function() {
          FB.init({
            xfbml            : true,
            version          : 'v6.0'
          });
        };

        (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js';
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));</script>

      <!-- Your customer chat code -->
      <div class="fb-customerchat"
        attribution=setup_tool
        page_id="100530371308328"
  theme_color="#01579b"
  logged_in_greeting="Hi, kind visitor. How can we help you today?"
  logged_out_greeting="Hi, kind visitor. How can we help you today?">
      </div>

<!-- featured post -->
<section class="feat-post-slider section-sm">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-10 featured-post-slider">
        <!-- slider item -->
        {{ range first 3 ( where .Site.RegularPages "Type" "post" )}}
        <article class="card featured-post">
          <div class="row no-gutters align-items-center">
            <div class="col-md-5">
              {{ if .Params.Image }}
              <img src="{{ .Params.Image | absURL }}" class="card-img" alt="{{ .Title | markdownify }}">
              {{ end }}
            </div>
            <div class="col-md-6 offset-md-1">
              <div class="card-body">
                <div class="mb-3 post-meta">
                  {{ $authors := partialCached "func/GetArticleAuthors" . .File.UniqueID }}
                  {{ if eq (len $authors) 1 }}
                      {{ with $author := index $authors 0 }}
                                  {{ with .name }}
                                  <span>By {{ . }}</span>
                                  {{ end }}
                      {{ end }}
                  {{ else }}
                      <span>By 
                                  {{ range $index, $author := $authors }}
                                      {{ .firstname }}{{ if ne (add $index 1) (len $authors) }},{{ end }}
                                  {{ end }}</span>
                  {{ end }}

                  {{ if .Params.date }}

                  {{ if .Params.authors }}
                  <span> · </span>
                  {{ end }}

                  {{ if eq .Params.lastmod .Params.date }}
                      <span>{{ .PublishDate.Format "02 January 2006" }}</span>
                  {{ else }}
                      <span>Updated {{ .Lastmod.Format "02 January 2006" }}</span>
                  {{ end }}
                  {{ end }}

                </div>
                <a href="{{ .Permalink }}"
                  class="h2 font-weight-bold d-block text-dark mb-4 card-title">{{ .Title | markdownify }}</a>
                <p class="card-text">{{.Description}}</p>
              </div>
            </div>
          </div>
        </article>
        {{ end }}
      </div>
    </div>
  </div>
</section>
<!-- /featured post -->

<!-- blog post -->
<section class="recent-post-section section pb-0">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 mb-5 mb-lg-0">
        <div class="row">
          {{ $paginator := .Paginate (where .Site.RegularPages "Type" "post") }}
          {{ range $paginator.Pages }}
          <div class="col-md-6 mb-4">
            <article class="card">
              {{ if .Params.Image }}
              <img src="{{ .Params.Image | absURL }}" class="card-img-top" alt="{{ .Title | markdownify }}">
              {{ end }}
              <div class="card-body px-0">
                {{ range .Params.Categories }}
                <a href="{{ `categories/` | relLangURL }}{{ . | urlize | lower }}"
                  class="category-text text-primary">{{ . | title | humanize }}</a>
                {{ end }}
                <a href="{{ .Permalink }}" class="h5 d-block my-3">{{ .Title | markdownify }}</a>
                <div class="mb-3 post-meta">
                  {{ $authors := partialCached "func/GetArticleAuthors" . .File.UniqueID }}
                  {{ if eq (len $authors) 1 }}
                      {{ with $author := index $authors 0 }}
                                  {{ with .name }}
                                  <span>By {{ . }}</span>
                                  {{ end }}
                      {{ end }}
                  {{ else }}
                      <span>By 
                                  {{ range $index, $author := $authors }}
                                      {{ .firstname }}{{ if ne (add $index 1) (len $authors) }},{{ end }}
                                  {{ end }}</span>
                  {{ end }}

                  {{ if .Params.date }}

                  {{ if .Params.authors }}
                  <span> · </span>
                  {{ end }}

                  {{ if eq .Params.lastmod .Params.date }}
                      <span>{{ .PublishDate.Format "02 January 2006" }}</span>
                  {{ else }}
                      <span>Updated {{ .Lastmod.Format "02 January 2006" }}</span>
                  {{ end }}
                  {{ end }}

                </div>
                <p class="card-text">{{ .Description }}</p>
                <a href="{{ .Permalink }}" class="btn btn-outline-primary">read more</a>
              </div>
            </article>
          </div>
          {{ end }}
        </div>
      </div>
      <!-- sidebar -->
      {{ partial "sidebar.html" . }}
      <!-- /sidebar -->

      <!-- pagination -->
      <div class="col-12 mt-5">
        {{ template "_internal/pagination.html" . }}
      </div>
    </div>
  </div>
</section>
<!-- /blog post -->

{{ end }}